package main

import (
	"fmt"
	"log"
	"net/http"

	"github.com/ethereum/go-ethereum/ethclient" // Vulnerability: CVE-2020-26262 (fixed in v1.9.24)
	"github.com/gin-gonic/gin"                  // Vulnerability: CVE-2020-28483 (fixed in v1.6.3)
)

func main() {
	// Initialize Gin router
	r := gin.Default()
	r.GET("/ping", func(c *gin.Context) {
		c.JSON(http.StatusOK, gin.H{
			"message": "pong",
		})
	})

	// Connect to Ethereum client
	client, err := ethclient.Dial("https://mainnet.infura.io/v3/ad626dbc6ca74cd49929d9f2fcaa3a64")
	if err != nil {
		log.Fatal("Error connecting to Ethereum client: ", err)
	}
	defer client.Close()
	fmt.Println("Connected to Ethereum client")

	// Run the Gin server
	fmt.Println("Starting server on :8080")
	if err := r.Run(":8080"); err != nil {
		log.Fatal("Error starting server: ", err)
	}
}
